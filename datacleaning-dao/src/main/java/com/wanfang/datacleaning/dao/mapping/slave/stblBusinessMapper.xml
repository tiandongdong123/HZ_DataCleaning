<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.wanfang.datacleaning.dao.dao.slave.STblBusinessDao">
    <resultMap id="BaseEntNameResultMap" type="com.wanfang.datacleaning.dao.model.master.bo.BusinessEntNameBO">
        <id column="ID" property="id" jdbcType="BIGINT"/>
        <result column="PRIPID" property="pripid" jdbcType="VARCHAR"/>
        <result column="ENTNAME" property="entName" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap id="ExtraFieldResultMap" type="com.wanfang.datacleaning.dao.model.master.bo.BusinessExtraFieldBO">
        <id column="ID" property="id" jdbcType="BIGINT"/>
        <result column="ENTNAME" property="entName" jdbcType="VARCHAR"/>
        <result column="ENTSTATUS" property="entStatus" jdbcType="VARCHAR"/>
        <result column="ABUITEM" property="abuItem" jdbcType="VARCHAR"/>
        <result column="ESDATE" property="esDate" jdbcType="DATE"/>
        <result column="REGORG" property="regOrg" jdbcType="VARCHAR"/>
        <result column="LOCALADM" property="localAdm" jdbcType="VARCHAR"/>
        <result column="ESYEAR" property="esYear" jdbcType="INTEGER"/>
        <result column="ESMONTH" property="esMonth" jdbcType="INTEGER"/>
        <result column="DOMPRORIGHT" property="domProRight" jdbcType="VARCHAR"/>
        <result column="HAS_ABUITEM" property="hasAbuItem" jdbcType="INTEGER"/>
        <result column="PROVINCE" property="province" jdbcType="INTEGER"/>
        <result column="CITY" property="city" jdbcType="INTEGER"/>
        <result column="AREA" property="area" jdbcType="INTEGER"/>
        <result column="UPDATE_TIME" property="updateTime" jdbcType="BIGINT"/>
    </resultMap>

    <resultMap id="HighNewResultMap" type="com.wanfang.datacleaning.dao.model.master.bo.BusinessHighNewInfoBO">
        <id column="ID" property="id" jdbcType="BIGINT"/>
        <result column="ENTNAME" property="entName" jdbcType="VARCHAR"/>
        <result column="HIGHNEWENTER" property="highNewEnter" jdbcType="INTEGER"/>
        <result column="UPDATE_TIME" property="updateTime" jdbcType="BIGINT"/>
    </resultMap>

    <resultMap id="PatentFieldResultMap" type="com.wanfang.datacleaning.dao.model.master.bo.BusinessPatentInfoBO">
        <id column="ID" property="id" jdbcType="BIGINT"/>
        <result column="ENTNAME" property="entName" jdbcType="VARCHAR"/>
        <result column="OPFROM" property="opFrom" jdbcType="DATE"/>
        <result column="OPTO" property="opTo" jdbcType="DATE"/>
        <result column="HAS_PATENT" property="hasPatent" jdbcType="INTEGER"/>
        <result column="PATENT_TYPE_LIST" property="patentTypeList" jdbcType="VARCHAR"/>
        <result column="PATENT_NUM" property="patentNum" jdbcType="INTEGER"/>
        <result column="UPDATE_TIME" property="updateTime" jdbcType="BIGINT"/>
    </resultMap>

    <resultMap id="StandardFieldResultMap" type="com.wanfang.datacleaning.dao.model.master.bo.BusinessStandardInfoBO">
        <id column="ID" property="id" jdbcType="BIGINT"/>
        <result column="ENTNAME" property="entName" jdbcType="VARCHAR"/>
        <result column="HAS_DRSTANDARD" property="hasDrStandard" jdbcType="INTEGER"/>
        <result column="DRSTANDARD_TYPE_LIST" property="drStandardTypeList" jdbcType="VARCHAR"/>
        <result column="DRSTANDARD_NUM" property="drStandardNum" jdbcType="INTEGER"/>
        <result column="UPDATE_TIME" property="updateTime" jdbcType="BIGINT"/>
    </resultMap>

    <resultMap id="locationFieldResultMap" type="com.wanfang.datacleaning.dao.model.master.bo.BusinessLocationInfoBO">
        <id column="ID" property="id" jdbcType="BIGINT"/>
        <result column="DOM" property="dom" jdbcType="VARCHAR"/>
        <result column="PROVINCE" property="province" jdbcType="INTEGER"/>
        <result column="CITY" property="city" jdbcType="INTEGER"/>
        <result column="AREA" property="area" jdbcType="INTEGER"/>
        <result column="LAT_LON" property="latLon" jdbcType="VARCHAR"/>
        <result column="UPDATE_TIME" property="updateTime" jdbcType="BIGINT"/>
    </resultMap>

    <resultMap id="CapFieldResultMap" type="com.wanfang.datacleaning.dao.model.master.bo.BusinessCapInfoBO">
        <id column="ID" property="id" jdbcType="BIGINT"/>
        <result column="REGCAP" property="regCap" jdbcType="DECIMAL"/>
        <result column="REGCAPCUR" property="regCapCur" jdbcType="VARCHAR"/>
        <result column="REGCAP_RMB" property="regCapRmb" jdbcType="DECIMAL"/>
        <result column="UPDATE_TIME" property="updateTime" jdbcType="BIGINT"/>
    </resultMap>

    <resultMap id="UsCreditCodeResultMap" type="com.wanfang.datacleaning.dao.model.master.bo.UsCreditCodeBO">
        <id column="ID" property="id" jdbcType="BIGINT"/>
        <result column="PRIPID" property="pripid" jdbcType="VARCHAR"/>
        <result column="CREDITCODE" property="usCreditCode" jdbcType="VARCHAR"/>
        <result column="UPDATE_TIME" property="updateTime" jdbcType="BIGINT"/>
    </resultMap>

    <!--分页获取企业(机构)名称信息-->
    <select id="getBaseEntNameInfoByPage" resultMap="BaseEntNameResultMap">
        SELECT
          ID,PRIPID, ENTNAME
        FROM tblBusiness
        WHERE
          ID <![CDATA[ > ]]> #{startIndex}
        ORDER BY ID
        LIMIT #{pageSize}
    </select>

    <!--分页获取拓展字段信息-->
    <select id="getExtraFieldInfoByPage" resultMap="ExtraFieldResultMap">
        SELECT
          ID,ENTNAME,ENTSTATUS,ABUITEM,ESDATE,REGORG,LOCALADM,ESYEAR,ESMONTH,DOMPRORIGHT,HAS_ABUITEM,PROVINCE,CITY,AREA,UPDATE_TIME
        FROM tblBusiness
        WHERE
          ID <![CDATA[ > ]]> #{startIndex}
        ORDER BY ID
        LIMIT #{pageSize}
    </select>

    <!--更新拓展字段信息-->
    <update id="updateExtraFieldByKey"
            parameterType="com.wanfang.datacleaning.dao.model.master.bo.BusinessExtraFieldBO">
        UPDATE tblBusiness
        <set>
            <if test="entStatus != null and entStatus != ''">
                ENTSTATUS = #{entStatus},
            </if>
            <if test="esYear != null">
                ESYEAR = #{esYear},
            </if>
            <if test="esMonth != null">
                ESMONTH = #{esMonth},
            </if>
            <if test="domProRight != null and domProRight != ''">
                DOMPRORIGHT = #{domProRight},
            </if>
            <if test="hasAbuItem != null">
                HAS_ABUITEM = #{hasAbuItem},
            </if>
            <if test="province != null">
                PROVINCE = #{province},
            </if>
            <if test="city != null">
                CITY = #{city},
            </if>
            <if test="area != null">
                AREA = #{area},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = #{updateTime},
            </if>
        </set>
        <where>
            AND ID = #{id}
        </where>
    </update>

    <!--批量更新拓展字段信息-->
    <update id="updateBatchExtraFieldByKey" parameterType="java.util.List">
        <foreach collection="list" separator=";" item="item">
            UPDATE tblBusiness
            <set>
                <if test="item.entStatus != null and item.entStatus != ''">
                    ENTSTATUS = #{item.entStatus},
                </if>
                <if test="item.esYear != null">
                    ESYEAR = #{item.esYear},
                </if>
                <if test="item.esMonth != null">
                    ESMONTH = #{item.esMonth},
                </if>
                <if test="item.domProRight != null and item.domProRight != ''">
                    DOMPRORIGHT = #{item.domProRight},
                </if>
                <if test="item.hasAbuItem != null">
                    HAS_ABUITEM = #{item.hasAbuItem},
                </if>
                <if test="item.province != null">
                    PROVINCE = #{item.province},
                </if>
                <if test="item.city != null">
                    CITY = #{item.city},
                </if>
                <if test="item.area != null">
                    AREA = #{item.area},
                </if>
                <if test="item.updateTime != null">
                    UPDATE_TIME = #{item.updateTime},
                </if>
            </set>
            <where>
                AND ID = #{item.id}
            </where>
        </foreach>
    </update>


    <!--分页获取高新技术信息-->
    <select id="getHighNewInfoByPage" resultMap="HighNewResultMap">
        SELECT
          ID,ENTNAME,HIGHNEWENTER,UPDATE_TIME
        FROM tblBusiness
        WHERE
          ID <![CDATA[ > ]]> #{startIndex}
        ORDER BY ID
        LIMIT #{pageSize}
    </select>

    <!--更新高新技术信息-->
    <update id="updateHighNewInfoByKey"
            parameterType="com.wanfang.datacleaning.dao.model.master.bo.BusinessHighNewInfoBO">
        UPDATE tblBusiness
        <set>
            <if test="highNewEnter != null">
                HIGHNEWENTER = #{highNewEnter},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = #{updateTime},
            </if>
        </set>
        <where>
            AND ID = #{id}
        </where>
    </update>

    <!--批量更新高新技术信息-->
    <update id="updateBatchHighNewInfoByKey" parameterType="java.util.List">
        <foreach collection="list" separator=";" item="item">
            UPDATE tblBusiness
            <set>
                <if test="item.highNewEnter != null">
                    HIGHNEWENTER = #{item.highNewEnter},
                </if>
                <if test="item.updateTime != null">
                    UPDATE_TIME = #{item.updateTime},
                </if>
            </set>
            <where>
                AND ID = #{item.id}
            </where>
        </foreach>
    </update>

    <!--分页获取专利信息-->
    <select id="getPatentInfoByPage" resultMap="PatentFieldResultMap">
        SELECT
          ID,ENTNAME,HAS_PATENT,PATENT_TYPE_LIST,PATENT_NUM,UPDATE_TIME
        FROM tblBusiness
        WHERE
          ID <![CDATA[ > ]]> #{startIndex}
        ORDER BY ID
        LIMIT #{pageSize}
    </select>

    <!--更新专利信息-->
    <update id="updatePatentInfoByKey"
            parameterType="com.wanfang.datacleaning.dao.model.master.bo.BusinessPatentInfoBO">
        UPDATE tblBusiness
        <set>
            <if test="hasPatent != null">
                HAS_PATENT = #{hasPatent},
            </if>
            <if test="patentTypeList != null and patentTypeList != ''">
                PATENT_TYPE_LIST = #{patentTypeList},
            </if>
            <if test="patentNum != null">
                PATENT_NUM = #{patentNum},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = #{updateTime},
            </if>
        </set>
        <where>
            AND ID = #{id}
        </where>
    </update>

    <!--批量更新专利信息-->
    <update id="updateBatchPatentInfoByKey" parameterType="java.util.List">
        <foreach collection="list" separator=";" item="item">
            UPDATE tblBusiness
            <set>
                <if test="item.hasPatent != null">
                    HAS_PATENT = #{item.hasPatent},
                </if>
                <if test="item.patentTypeList != null and item.patentTypeList != ''">
                    PATENT_TYPE_LIST = #{item.patentTypeList},
                </if>
                <if test="item.patentNum != null">
                    PATENT_NUM = #{item.patentNum},
                </if>
                <if test="item.updateTime != null">
                    UPDATE_TIME = #{item.updateTime},
                </if>
            </set>
            <where>
                AND ID = #{item.id}
            </where>
        </foreach>
    </update>

    <!--分页获取标准信息-->
    <select id="getStandardInfoByPage" resultMap="StandardFieldResultMap">
        SELECT
          ID,ENTNAME,HAS_DRSTANDARD,DRSTANDARD_TYPE_LIST,DRSTANDARD_NUM,UPDATE_TIME
        FROM tblBusiness
        WHERE
          ID <![CDATA[ > ]]> #{startIndex}
        ORDER BY ID
        LIMIT #{pageSize}
    </select>

    <!--更新标准信息-->
    <update id="updateStandardInfoByKey"
            parameterType="com.wanfang.datacleaning.dao.model.master.bo.BusinessStandardInfoBO">
        UPDATE tblBusiness
        <set>
            <if test="hasDrStandard != null">
                HAS_DRSTANDARD = #{hasDrStandard},
            </if>
            <if test="drStandardTypeList != null and drStandardTypeList != ''">
                DRSTANDARD_TYPE_LIST = #{drStandardTypeList},
            </if>
            <if test="drStandardNum != null">
                DRSTANDARD_NUM = #{drStandardNum},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = #{updateTime},
            </if>
        </set>
        <where>
            AND ID = #{id}
        </where>
    </update>

    <!--批量更新标准信息-->
    <update id="updateBatchStandardInfoByKey" parameterType="java.util.List">
        <foreach collection="list" separator=";" item="item">
            UPDATE tblBusiness
            <set>
                <if test="item.hasDrStandard != null">
                    HAS_DRSTANDARD = #{item.hasDrStandard},
                </if>
                <if test="item.drStandardTypeList != null and item.drStandardTypeList != ''">
                    DRSTANDARD_TYPE_LIST = #{item.drStandardTypeList},
                </if>
                <if test="item.drStandardNum != null">
                    DRSTANDARD_NUM = #{item.drStandardNum},
                </if>
                <if test="item.updateTime != null">
                    UPDATE_TIME = #{item.updateTime},
                </if>
            </set>
            <where>
                AND ID = #{item.id}
            </where>
        </foreach>
    </update>

    <!--分页获取位置信息-->
    <select id="getLocationInfoByPage" resultMap="locationFieldResultMap">
        SELECT
          ID,DOM,PROVINCE,CITY,AREA,LAT_LON,UPDATE_TIME
        FROM tblBusiness
        WHERE
          ID <![CDATA[ > ]]> #{startIndex}
        ORDER BY ID
        LIMIT #{pageSize}
    </select>

    <!--更新位置信息-->
    <update id="updateLocationInfoByKey"
            parameterType="com.wanfang.datacleaning.dao.model.master.bo.BusinessLocationInfoBO">
        UPDATE tblBusiness
        <set>
            <if test="latLon != null and latLon != ''">
                LAT_LON = #{latLon},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = #{updateTime},
            </if>
        </set>
        <where>
            AND ID = #{id}
        </where>
    </update>

    <!--批量更新位置信息-->
    <update id="updateBatchLocationInfoByKey" parameterType="java.util.List">
        <foreach collection="list" separator=";" item="item">
            UPDATE tblBusiness
            <set>
                <if test="item.latLon != null and item.latLon != ''">
                    LAT_LON = #{item.latLon},
                </if>
                <if test="item.updateTime != null">
                    UPDATE_TIME = #{item.updateTime},
                </if>
            </set>
            <where>
                AND ID = #{item.id}
            </where>
        </foreach>
    </update>

    <!--分页获取资金信息-->
    <select id="getCapInfoByPage" resultMap="CapFieldResultMap">
        SELECT
          ID,REGCAP,REGCAPCUR,REGCAP_RMB,UPDATE_TIME
        FROM tblBusiness
        WHERE
          ID <![CDATA[ > ]]> #{startIndex}
        ORDER BY ID
        LIMIT #{pageSize}
    </select>

    <!--更新资金信息-->
    <update id="updateCapInfoByKey" parameterType="com.wanfang.datacleaning.dao.model.master.bo.BusinessCapInfoBO">
        UPDATE tblBusiness
        <set>
            <if test="regCapRmb != null">
                REGCAP_RMB = #{regCapRmb},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = #{updateTime},
            </if>
        </set>
        <where>
            AND ID = #{id}
        </where>
    </update>

    <!--批量更新资金信息-->
    <update id="updateBatchCapInfoByKey" parameterType="java.util.List">
        <foreach collection="list" separator=";" item="item">
            UPDATE tblBusiness
            <set>
                <if test="item.regCapRmb != null">
                    REGCAP_RMB = #{item.regCapRmb},
                </if>
                <if test="item.updateTime != null">
                    UPDATE_TIME = #{item.updateTime},
                </if>
            </set>
            <where>
                AND ID = #{item.id}
            </where>
        </foreach>
    </update>

    <!--分页获取统一社会信用代码信息-->
    <select id="getUsCreditCodeByPage" resultMap="UsCreditCodeResultMap">
        SELECT
          ID,PRIPID, USCREDITCODE,UPDATE_TIME
        FROM tblBusiness
        WHERE
          ID <![CDATA[ > ]]> #{startIndex}
        ORDER BY ID
        LIMIT #{pageSize}
    </select>

    <!--更新统一社会信用代码信息-->
    <update id="updateUsCreditCodeByKey" parameterType="com.wanfang.datacleaning.dao.model.master.bo.UsCreditCodeBO">
        UPDATE tblBusiness
        <set>
            <if test="usCreditCode != null">
                CREDITCODE = #{usCreditCode},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = #{updateTime},
            </if>
        </set>
        <where>
            AND ID = #{id}
        </where>
    </update>

    <!--批量更新统一社会信用代码信息-->
    <update id="updateBatchUsCreditCodeByKey" parameterType="java.util.List">
        <foreach collection="list" separator=";" item="item">
            UPDATE tblBusiness
            <set>
                <if test="item.usCreditCode != null">
                    CREDITCODE = #{item.usCreditCode},
                </if>
                <if test="item.updateTime != null">
                    UPDATE_TIME = #{item.updateTime},
                </if>
            </set>
            <where>
                AND ID = #{item.id}
            </where>
        </foreach>
    </update>

</mapper>